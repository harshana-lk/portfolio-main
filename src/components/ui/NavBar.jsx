import { useEffect, useRef } from "react";
import { gsap } from "gsap";
import Lenis from "lenis";

import { ScrollTrigger } from "gsap/ScrollTrigger";

export default function NavBar({ sectionRefs }) {
  const navBar = useRef(null);
  const logo = useRef(null);
  const cta = useRef(null);
  const tl = gsap.timeline();
  gsap.registerPlugin(ScrollTrigger);

  useEffect(() => {
    const lenis = new Lenis();
    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }
    requestAnimationFrame(raf);
  });

  useEffect(() => {
    tl.to(navBar.current, {
      y: 0,
      duration: 3,
      delay: 0.5,
      ease: "power4.inOut",
    });
  });

  useEffect(() => {
    sectionRefs.forEach((section) => {
      ScrollTrigger.create({
        trigger: section,
        start: "top 375px",
        end: "bottom 300px",
        // markers: true,
        animation: gsap
          .timeline()
          .to(navBar.current, { color: "#DDDDD5" })
          .to(cta.current, { backgroundColor: "#D1D1C7", color: "#0E0E0C" }, 0)
          .to(".bg-secondary-100", { backgroundColor: "#0E0E0C" }, 0),

        toggleActions: "restart reverse restart reverse",
      });
    });
  });

  return (
    <header
      ref={navBar}
      className="fixed top-0 z-50 flex w-full -translate-y-full items-center justify-between bg-secondary-100 px-5 py-3"
    >
      {/* logo */}
      <a href="#hero" aria-label="Logo" className="z-50">
        <svg
          ref={logo}
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          width="121"
          zoomAndPan="magnify"
          viewBox="0 0 90.75 33.749998"
          height="45"
          preserveAspectRatio="xMidYMid meet"
          version="1.0"
        >
          <defs>
            <g />
            <clipPath id="e81cf3bc5d">
              <path
                d="M 53.246094 6.316406 L 89 6.316406 L 89 24.871094 L 53.246094 24.871094 Z M 53.246094 6.316406 "
                clip-rule="nonzero"
              />
            </clipPath>
            <clipPath id="3c711198ef">
              <path
                d="M 70.453125 6.316406 L 82.988281 6.316406 C 85.121094 6.316406 87.089844 7.460938 88.148438 9.316406 C 89.203125 11.167969 89.1875 13.449219 88.097656 15.285156 L 87.730469 15.902344 C 84.441406 21.460938 78.457031 24.871094 71.996094 24.871094 L 59.464844 24.871094 C 57.332031 24.871094 55.359375 23.726562 54.304688 21.871094 C 53.246094 20.019531 53.265625 17.738281 54.355469 15.902344 L 54.71875 15.285156 C 58.011719 9.726562 63.992188 6.316406 70.453125 6.316406 Z M 70.453125 6.316406 "
                clip-rule="nonzero"
              />
            </clipPath>
            <clipPath id="0b3892954d">
              <path
                d="M 0.210938 0 L 61 0 L 61 32 L 0.210938 32 Z M 0.210938 0 "
                clip-rule="nonzero"
              />
            </clipPath>
          </defs>
          <g clip-path="url(#e81cf3bc5d)">
            <g clip-path="url(#3c711198ef)">
              <path
                fill="#000000"
                d="M 49.042969 6.316406 L 93.402344 6.316406 L 93.402344 24.871094 L 49.042969 24.871094 Z M 49.042969 6.316406 "
                fill-opacity="1"
                fill-rule="nonzero"
              />
            </g>
          </g>
          <g clip-path="url(#0b3892954d)">
            <path
              stroke-linecap="butt"
              transform="matrix(0.292987, 0, 0, 0.292987, 0.209561, 4.753205)"
              fill="none"
              stroke-linejoin="miter"
              d="M 22.829956 28.827284 C 25.989761 28.827284 28.536271 29.827223 30.456152 31.840432 C 32.376034 33.853641 33.335975 36.520143 33.335975 39.866604 L 33.335975 57.998819 L 24.096544 57.998819 L 24.096544 42.426446 C 24.096544 40.746549 23.643239 39.426631 22.736628 38.453357 C 21.830017 37.480084 20.603426 36.986781 19.03019 36.986781 C 17.256966 36.986781 15.830387 37.626742 14.763786 38.906663 C 13.710518 40.186584 13.177218 41.826483 13.177218 43.813027 L 13.177218 57.998819 L 3.95112 57.998819 L 3.95112 18.427926 L 13.177218 18.427926 L 13.177218 34.000299 C 15.203759 30.627173 18.416895 28.893947 22.829956 28.827284 Z M 49.708298 28.827284 C 53.654722 28.827284 56.721199 29.733895 58.894399 31.573782 C 61.080931 33.400336 62.200861 35.946845 62.227526 39.226643 L 62.227526 57.998819 L 53.214749 57.998819 L 53.214749 54.692356 C 51.334865 57.185536 48.401712 58.425459 44.415291 58.425459 C 41.402144 58.425459 39.002292 57.598844 37.215735 55.93228 C 35.442511 54.252383 34.562566 52.079184 34.562566 49.426014 C 34.562566 46.679517 35.509174 44.546315 37.415723 43.039741 C 39.30894 41.533168 42.042104 40.759882 45.588552 40.719884 L 53.161419 40.719884 L 53.161419 40.293244 C 53.161419 38.866665 52.694781 37.760067 51.748173 36.960116 C 50.814897 36.160166 49.414983 35.76019 47.575097 35.76019 C 44.975257 35.76019 42.108767 36.560141 38.988959 38.160042 L 36.375787 32.080417 C 41.028834 29.907218 45.46856 28.827284 49.708298 28.827284 Z M 47.241784 52.199177 C 48.695028 52.199177 49.988281 51.825866 51.081547 51.105911 C 52.188146 50.372623 52.881436 49.412682 53.161419 48.239421 L 53.161419 45.679579 L 47.361776 45.679579 C 44.588614 45.679579 43.1887 46.706182 43.1887 48.772721 C 43.1887 49.839322 43.548678 50.67927 44.255301 51.279233 C 44.975257 51.892529 45.961863 52.199177 47.241784 52.199177 Z M 74.973407 29.253925 L 74.973407 34.106959 C 77.013281 30.667171 80.119757 28.893947 84.306165 28.827284 L 84.306165 37.146771 C 81.67966 36.893454 79.533126 37.333426 77.85323 38.453357 C 76.186666 39.573288 75.226725 41.159857 74.973407 43.226396 L 74.973407 57.998819 L 65.760642 57.998819 L 65.760642 29.253925 Z M 95.772125 28.827284 C 100.011863 28.827284 103.958287 29.907218 107.611395 32.080417 L 104.478255 38.053382 C 100.918474 36.1335 97.891994 35.17356 95.398815 35.17356 C 93.51893 35.17356 92.572322 35.826853 92.572322 37.146771 C 92.572322 37.853394 93.09229 38.453357 94.118893 38.933328 C 95.158829 39.413298 96.412085 39.853271 97.905327 40.239914 C 99.398568 40.626557 100.891809 41.11986 102.358385 41.70649 C 103.838294 42.293121 105.09155 43.226396 106.131486 44.506318 C 107.158089 45.786239 107.678057 47.346142 107.678057 49.199362 C 107.678057 52.079184 106.544794 54.332378 104.304932 55.958945 C 102.06507 57.572179 99.14525 58.372129 95.572137 58.372129 C 90.479118 58.372129 86.172717 57.025546 82.666266 54.319046 L 85.599419 48.452741 C 88.972544 50.83926 92.359002 52.025854 95.772125 52.025854 C 97.878662 52.025854 98.93193 51.372561 98.93193 50.052642 C 98.93193 49.306022 98.411962 48.692726 97.398691 48.199423 C 96.38542 47.692788 95.145497 47.239482 93.692253 46.85284 C 92.239009 46.466197 90.772433 45.972894 89.319189 45.399596 C 87.865946 44.812965 86.639355 43.893022 85.612751 42.653098 C 84.59948 41.399842 84.092845 39.826606 84.092845 37.946722 C 84.092845 35.0669 85.186111 32.827038 87.345978 31.227136 C 89.519177 29.627235 92.332337 28.827284 95.772125 28.827284 Z M 128.943413 28.827284 C 132.116551 28.827284 134.66306 29.827223 136.569609 31.840432 C 138.489491 33.853641 139.449432 36.520143 139.449432 39.866604 L 139.449432 57.998819 L 130.223334 57.998819 L 130.223334 42.426446 C 130.223334 40.746549 129.770029 39.426631 128.850085 38.453357 C 127.956807 37.480084 126.716883 36.986781 125.15698 36.986781 C 123.383756 36.986781 121.957177 37.626742 120.890576 38.906663 C 119.823975 40.186584 119.304007 41.826483 119.304007 43.813027 L 119.304007 57.998819 L 110.064577 57.998819 L 110.064577 18.427926 L 119.304007 18.427926 L 119.304007 34.000299 C 121.317216 30.627173 124.530352 28.893947 128.943413 28.827284 Z M 170.914158 29.253925 L 170.914158 57.998819 L 161.68806 57.998819 L 161.68806 53.252445 C 159.728181 56.665568 156.621706 58.372129 152.368635 58.372129 C 149.222162 58.372129 146.728983 57.385523 144.862431 55.398979 C 142.99588 53.399103 142.062604 50.7326 142.062604 47.38614 L 142.062604 29.253925 L 151.288702 29.253925 L 151.288702 44.772968 C 151.288702 46.479529 151.728675 47.826113 152.595288 48.812719 C 153.461901 49.785992 154.62183 50.265962 156.088406 50.265962 C 157.834965 50.225965 159.194881 49.586004 160.181487 48.332748 C 161.181425 47.052827 161.68806 45.426261 161.68806 43.439717 L 161.68806 29.253925 Z M 170.914158 29.253925 "
              stroke="#ffffff"
              stroke-width="5.999996"
              stroke-opacity="1"
              stroke-miterlimit="4"
            />
          </g>
          <g fill="#000000" fill-opacity="1">
            <g transform="translate(0.209561, 21.74644)">
              <g>
                <path d="M 6.6875 -8.546875 C 7.613281 -8.546875 8.359375 -8.25 8.921875 -7.65625 C 9.484375 -7.070312 9.765625 -6.289062 9.765625 -5.3125 L 9.765625 0 L 7.0625 0 L 7.0625 -4.5625 C 7.0625 -5.050781 6.925781 -5.4375 6.65625 -5.71875 C 6.394531 -6.007812 6.035156 -6.15625 5.578125 -6.15625 C 5.054688 -6.15625 4.640625 -5.96875 4.328125 -5.59375 C 4.015625 -5.21875 3.859375 -4.738281 3.859375 -4.15625 L 3.859375 0 L 1.15625 0 L 1.15625 -11.59375 L 3.859375 -11.59375 L 3.859375 -7.03125 C 4.453125 -8.019531 5.394531 -8.523438 6.6875 -8.546875 Z M 6.6875 -8.546875 " />
              </g>
            </g>
          </g>
          <g fill="#000000" fill-opacity="1">
            <g transform="translate(9.912232, 21.74644)">
              <g>
                <path d="M 4.859375 -8.546875 C 6.015625 -8.546875 6.910156 -8.273438 7.546875 -7.734375 C 8.191406 -7.203125 8.519531 -6.457031 8.53125 -5.5 L 8.53125 0 L 5.890625 0 L 5.890625 -0.96875 C 5.335938 -0.238281 4.476562 0.125 3.3125 0.125 C 2.425781 0.125 1.722656 -0.117188 1.203125 -0.609375 C 0.679688 -1.097656 0.421875 -1.734375 0.421875 -2.515625 C 0.421875 -3.316406 0.695312 -3.9375 1.25 -4.375 C 1.8125 -4.820312 2.613281 -5.050781 3.65625 -5.0625 L 5.875 -5.0625 L 5.875 -5.1875 C 5.875 -5.601562 5.734375 -5.925781 5.453125 -6.15625 C 5.179688 -6.394531 4.773438 -6.515625 4.234375 -6.515625 C 3.472656 -6.515625 2.632812 -6.28125 1.71875 -5.8125 L 0.953125 -7.59375 C 2.316406 -8.226562 3.617188 -8.546875 4.859375 -8.546875 Z M 4.140625 -1.703125 C 4.566406 -1.703125 4.941406 -1.804688 5.265625 -2.015625 C 5.585938 -2.234375 5.789062 -2.515625 5.875 -2.859375 L 5.875 -3.609375 L 4.171875 -3.609375 C 3.359375 -3.609375 2.953125 -3.304688 2.953125 -2.703125 C 2.953125 -2.390625 3.054688 -2.144531 3.265625 -1.96875 C 3.472656 -1.789062 3.765625 -1.703125 4.140625 -1.703125 Z M 4.140625 -1.703125 " />
              </g>
            </g>
          </g>
          <g fill="#000000" fill-opacity="1">
            <g transform="translate(18.396201, 21.74644)">
              <g>
                <path d="M 3.78125 -8.421875 L 3.78125 -7 C 4.375 -8.007812 5.285156 -8.523438 6.515625 -8.546875 L 6.515625 -6.109375 C 5.742188 -6.179688 5.113281 -6.050781 4.625 -5.71875 C 4.132812 -5.394531 3.851562 -4.929688 3.78125 -4.328125 L 3.78125 0 L 1.078125 0 L 1.078125 -8.421875 Z M 3.78125 -8.421875 " />
              </g>
            </g>
          </g>
          <g fill="#000000" fill-opacity="1">
            <g transform="translate(24.177144, 21.74644)">
              <g>
                <path d="M 4.09375 -8.546875 C 5.332031 -8.546875 6.488281 -8.226562 7.5625 -7.59375 L 6.640625 -5.84375 C 5.597656 -6.40625 4.710938 -6.6875 3.984375 -6.6875 C 3.429688 -6.6875 3.15625 -6.492188 3.15625 -6.109375 C 3.15625 -5.898438 3.304688 -5.722656 3.609375 -5.578125 C 3.910156 -5.441406 4.28125 -5.316406 4.71875 -5.203125 C 5.15625 -5.085938 5.585938 -4.941406 6.015625 -4.765625 C 6.453125 -4.597656 6.820312 -4.328125 7.125 -3.953125 C 7.425781 -3.578125 7.578125 -3.117188 7.578125 -2.578125 C 7.578125 -1.734375 7.25 -1.070312 6.59375 -0.59375 C 5.9375 -0.125 5.082031 0.109375 4.03125 0.109375 C 2.539062 0.109375 1.28125 -0.285156 0.25 -1.078125 L 1.109375 -2.796875 C 2.097656 -2.097656 3.09375 -1.75 4.09375 -1.75 C 4.707031 -1.75 5.015625 -1.941406 5.015625 -2.328125 C 5.015625 -2.546875 4.863281 -2.726562 4.5625 -2.875 C 4.269531 -3.019531 3.910156 -3.148438 3.484375 -3.265625 C 3.054688 -3.378906 2.628906 -3.519531 2.203125 -3.6875 C 1.773438 -3.863281 1.410156 -4.132812 1.109375 -4.5 C 0.816406 -4.863281 0.671875 -5.320312 0.671875 -5.875 C 0.671875 -6.71875 0.988281 -7.375 1.625 -7.84375 C 2.257812 -8.3125 3.082031 -8.546875 4.09375 -8.546875 Z M 4.09375 -8.546875 " />
              </g>
            </g>
          </g>
          <g fill="#000000" fill-opacity="1">
            <g transform="translate(31.301788, 21.74644)">
              <g>
                <path d="M 6.6875 -8.546875 C 7.613281 -8.546875 8.359375 -8.25 8.921875 -7.65625 C 9.484375 -7.070312 9.765625 -6.289062 9.765625 -5.3125 L 9.765625 0 L 7.0625 0 L 7.0625 -4.5625 C 7.0625 -5.050781 6.925781 -5.4375 6.65625 -5.71875 C 6.394531 -6.007812 6.035156 -6.15625 5.578125 -6.15625 C 5.054688 -6.15625 4.640625 -5.96875 4.328125 -5.59375 C 4.015625 -5.21875 3.859375 -4.738281 3.859375 -4.15625 L 3.859375 0 L 1.15625 0 L 1.15625 -11.59375 L 3.859375 -11.59375 L 3.859375 -7.03125 C 4.453125 -8.019531 5.394531 -8.523438 6.6875 -8.546875 Z M 6.6875 -8.546875 " />
              </g>
            </g>
          </g>
          <g fill="#000000" fill-opacity="1">
            <g transform="translate(41.004457, 21.74644)">
              <g>
                <path d="M 9.28125 -8.421875 L 9.28125 0 L 6.578125 0 L 6.578125 -1.390625 C 6.003906 -0.390625 5.09375 0.109375 3.84375 0.109375 C 2.925781 0.109375 2.191406 -0.179688 1.640625 -0.765625 C 1.097656 -1.347656 0.828125 -2.128906 0.828125 -3.109375 L 0.828125 -8.421875 L 3.53125 -8.421875 L 3.53125 -3.875 C 3.53125 -3.375 3.65625 -2.976562 3.90625 -2.6875 C 4.164062 -2.40625 4.507812 -2.265625 4.9375 -2.265625 C 5.445312 -2.273438 5.847656 -2.460938 6.140625 -2.828125 C 6.429688 -3.203125 6.578125 -3.679688 6.578125 -4.265625 L 6.578125 -8.421875 Z M 9.28125 -8.421875 " />
              </g>
            </g>
          </g>
          <g fill="#ffffff" fill-opacity="1">
            <g transform="translate(53.434132, 21.74644)">
              <g>
                <path d="M 0.953125 -2.125 C 1.191406 -2.363281 1.503906 -2.484375 1.890625 -2.484375 C 2.273438 -2.484375 2.585938 -2.363281 2.828125 -2.125 C 3.078125 -1.882812 3.203125 -1.570312 3.203125 -1.1875 C 3.203125 -0.800781 3.078125 -0.484375 2.828125 -0.234375 C 2.585938 0.00390625 2.273438 0.125 1.890625 0.125 C 1.503906 0.125 1.191406 0.00390625 0.953125 -0.234375 C 0.710938 -0.484375 0.59375 -0.800781 0.59375 -1.1875 C 0.59375 -1.570312 0.710938 -1.882812 0.953125 -2.125 Z M 0.953125 -2.125 " />
              </g>
            </g>
          </g>
          <g fill="#ffffff" fill-opacity="1">
            <g transform="translate(56.340184, 21.74644)">
              <g>
                <path d="M 9.5625 -11.59375 L 9.5625 0 L 6.859375 0 L 6.859375 -1.109375 C 6.242188 -0.296875 5.398438 0.109375 4.328125 0.109375 C 3.140625 0.109375 2.1875 -0.289062 1.46875 -1.09375 C 0.75 -1.894531 0.390625 -2.945312 0.390625 -4.25 C 0.390625 -5.539062 0.742188 -6.578125 1.453125 -7.359375 C 2.160156 -8.140625 3.097656 -8.53125 4.265625 -8.53125 C 5.378906 -8.53125 6.242188 -8.125 6.859375 -7.3125 L 6.859375 -11.59375 Z M 3.625 -2.59375 C 3.96875 -2.1875 4.421875 -1.984375 4.984375 -1.984375 C 5.546875 -1.984375 6 -2.1875 6.34375 -2.59375 C 6.6875 -3 6.859375 -3.53125 6.859375 -4.1875 C 6.859375 -4.832031 6.6875 -5.359375 6.34375 -5.765625 C 6 -6.171875 5.546875 -6.375 4.984375 -6.375 C 4.421875 -6.375 3.96875 -6.171875 3.625 -5.765625 C 3.28125 -5.367188 3.101562 -4.84375 3.09375 -4.1875 C 3.101562 -3.53125 3.28125 -3 3.625 -2.59375 Z M 3.625 -2.59375 " />
              </g>
            </g>
          </g>
          <g fill="#ffffff" fill-opacity="1">
            <g transform="translate(66.167852, 21.74644)">
              <g>
                <path d="M 4.765625 -8.515625 C 6.222656 -8.515625 7.316406 -8.066406 8.046875 -7.171875 C 8.785156 -6.273438 9.109375 -5.046875 9.015625 -3.484375 L 3.09375 -3.484375 C 3.226562 -2.984375 3.46875 -2.597656 3.8125 -2.328125 C 4.15625 -2.054688 4.578125 -1.921875 5.078125 -1.921875 C 5.847656 -1.921875 6.519531 -2.207031 7.09375 -2.78125 L 8.515625 -1.390625 C 7.609375 -0.398438 6.382812 0.09375 4.84375 0.09375 C 3.476562 0.09375 2.390625 -0.296875 1.578125 -1.078125 C 0.773438 -1.859375 0.375 -2.894531 0.375 -4.1875 C 0.375 -5.488281 0.773438 -6.535156 1.578125 -7.328125 C 2.390625 -8.117188 3.453125 -8.515625 4.765625 -8.515625 Z M 3.046875 -4.9375 L 6.421875 -4.9375 C 6.421875 -5.445312 6.269531 -5.859375 5.96875 -6.171875 C 5.675781 -6.484375 5.285156 -6.640625 4.796875 -6.640625 C 4.335938 -6.640625 3.953125 -6.484375 3.640625 -6.171875 C 3.328125 -5.867188 3.128906 -5.457031 3.046875 -4.9375 Z M 3.046875 -4.9375 " />
              </g>
            </g>
          </g>
          <g fill="#ffffff" fill-opacity="1">
            <g transform="translate(74.68307, 21.74644)">
              <g>
                <path d="M 5.859375 0 L 3.09375 0 L -0.078125 -8.421875 L 2.703125 -8.421875 L 4.515625 -2.46875 L 6.34375 -8.421875 L 9.03125 -8.421875 Z M 5.859375 0 " />
              </g>
            </g>
          </g>
        </svg>
      </a>
      <nav className=" space-x-7 font-grotesk text-body-3 sm:block">
        <a href="#about" className="group relative hidden md:inline-block">
          <span>about</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#services" className="group relative hidden md:inline-block">
          <span>services</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#works" className="group relative hidden md:inline-block">
          <span>projects</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a
          ref={cta}
          className="button group relative hover:bg-transparent"
          href="#contact"
        >
          <span className="relative w-fit">
            <span className="absolute bottom-2 h-[0.15em] w-0 bg-secondary-700 opacity-90 duration-300 ease-out group-hover:w-full"></span>
            <span>Let&apos;s Talk.</span>
          </span>
        </a>
      </nav>
    </header>
  );
}
